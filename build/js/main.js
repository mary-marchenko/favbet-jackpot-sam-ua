"use strict";
"use strict";

document.addEventListener('DOMContentLoaded', function () {
  var currentIndex = 1;
  var startX = 0;
  var isDragging = false;
  var slider = document.querySelector('.prize__slider');
  var items = document.querySelectorAll('.prize__item');
  var totalItems = items.length;
  function updateSlider() {
    items.forEach(function (item, index) {
      var distance = index - currentIndex;
      var newPosition = distance * 33.33;
      if (distance > totalItems / 2) {
        newPosition -= totalItems * 33.33;
      } else if (distance < -totalItems / 2) {
        newPosition += totalItems * 33.33;
      }
      var scale = index === currentIndex ? 1 : 0.8;
      item.style.transform = "translateX(".concat(newPosition, "%) scale(").concat(scale, ")");
      item.style.zIndex = index === currentIndex ? 2 : 1;
      var isVisible = Math.abs(distance) <= 1 || index === 0 && currentIndex === totalItems - 1 || index === totalItems - 1 && currentIndex === 0;
      item.classList.toggle('hidden', !isVisible);
      item.classList.toggle('active', index === currentIndex);
      item.classList.remove('left-slide', 'right-slide');
      if (distance === 1 || currentIndex === totalItems - 1 && index === 0) {
        item.classList.add('right-slide');
      } else if (distance === -1 || currentIndex === 0 && index === totalItems - 1) {
        item.classList.add('left-slide');
      }
    });
  }
  function moveSlider(offset) {
    currentIndex = (currentIndex + offset + totalItems) % totalItems;
    updateSlider();
  }
  function handleStart(event) {
    isDragging = true;
    startX = event.clientX || event.touches[0].clientX;
  }
  function handleMove(event) {
    if (!isDragging) return;
    var currentX = event.clientX || event.touches[0].clientX;
    var diffX = currentX - startX;
    if (Math.abs(diffX) > 50) {
      moveSlider(diffX > 0 ? -1 : 1);
      isDragging = false;
    }
  }
  function handleEnd() {
    isDragging = false;
  }
  var buttonsLeft = document.querySelectorAll('.button-slider-left');
  var buttonsRight = document.querySelectorAll('.button-slider-right');
  buttonsLeft.forEach(function (btn) {
    btn.addEventListener('click', function () {
      moveSlider(-1);
    });
  });
  buttonsRight.forEach(function (btn) {
    btn.addEventListener('click', function () {
      moveSlider(1);
    });
  });
  slider.addEventListener('mousedown', handleStart);
  slider.addEventListener('touchstart', handleStart);
  document.addEventListener('mousemove', handleMove);
  document.addEventListener('touchmove', handleMove);
  document.addEventListener('mouseup', handleEnd);
  document.addEventListener('touchend', handleEnd);
  updateSlider();
});

/********************************ANIMATION******************************/

var animItems = document.querySelectorAll('._anim-items');
if (animItems.length > 0) {
  var animOnScroll = function animOnScroll(params) {
    for (var index = 0; index < animItems.length; index++) {
      var animItem = animItems[index];
      var animItemHight = animItem.offsetHeight;
      var animItemOffSet = offset(animItem).top;
      var animStart = 4;
      var animItemPoint = window.innerHeight - animItemHight / animStart;
      if (animItemHight > window.innerHeight) {
        animItemPoint = window.innerHeight - window.innerHeight / animStart;
      }
      if (pageYOffset > animItemOffSet - animItemPoint && pageYOffset < animItemOffSet + animItemHight) {
        animItem.classList.add('_view');
      } else {
        if (!animItem.classList.contains('_anim-no-hide')) {
          animItem.classList.remove('_view');
        }
      }
    }
    function offset(el) {
      var rect = el.getBoundingClientRect(),
        scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,
        scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      return {
        top: rect.top + scrollTop,
        left: rect.left + scrollLeft
      };
    }
  };
  window.addEventListener('scroll', animOnScroll);
  setTimeout(function () {
    animOnScroll();
  }, 300);
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY3VycmVudEluZGV4Iiwic3RhcnRYIiwiaXNEcmFnZ2luZyIsInNsaWRlciIsInF1ZXJ5U2VsZWN0b3IiLCJpdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0b3RhbEl0ZW1zIiwibGVuZ3RoIiwidXBkYXRlU2xpZGVyIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsImRpc3RhbmNlIiwibmV3UG9zaXRpb24iLCJzY2FsZSIsInN0eWxlIiwidHJhbnNmb3JtIiwiY29uY2F0IiwiekluZGV4IiwiaXNWaXNpYmxlIiwiTWF0aCIsImFicyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImFkZCIsIm1vdmVTbGlkZXIiLCJvZmZzZXQiLCJoYW5kbGVTdGFydCIsImV2ZW50IiwiY2xpZW50WCIsInRvdWNoZXMiLCJoYW5kbGVNb3ZlIiwiY3VycmVudFgiLCJkaWZmWCIsImhhbmRsZUVuZCIsImJ1dHRvbnNMZWZ0IiwiYnV0dG9uc1JpZ2h0IiwiYnRuIiwiYW5pbUl0ZW1zIiwiYW5pbU9uU2Nyb2xsIiwicGFyYW1zIiwiYW5pbUl0ZW0iLCJhbmltSXRlbUhpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwiYW5pbUl0ZW1PZmZTZXQiLCJ0b3AiLCJhbmltU3RhcnQiLCJhbmltSXRlbVBvaW50Iiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJwYWdlWU9mZnNldCIsImNvbnRhaW5zIiwiZWwiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwic2Nyb2xsTGVmdCIsInBhZ2VYT2Zmc2V0IiwiZG9jdW1lbnRFbGVtZW50Iiwic2Nyb2xsVG9wIiwibGVmdCIsInNldFRpbWVvdXQiXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQUEsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxZQUFZO0VBQ3RELElBQUlDLFlBQVksR0FBRyxDQUFDO0VBQ3BC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Q0FBQztNQUNuQyxDQUFDLE1BQU87UUFDSixJQUFHLENBQUNpQixRQUFRLENBQUNwQixTQUFTLENBQUM4QixRQUFRLENBQUMsZUFBZSxDQUFDLEVBQUM7VUFDN0NWLFFBQVEsQ0FBQ3BCLFNBQVMsQ0FBQ0UsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUN0QztNQUNKO0lBQ0o7SUFFQSxTQUFTRyxNQUFNQSxDQUFDMEIsRUFBRSxFQUFFO01BQ2hCLElBQUlDLElBQUksR0FBR0QsRUFBRSxDQUFDRSxxQkFBcUIsQ0FBQyxDQUFDO1FBQ2pDQyxVQUFVLEdBQUdQLE1BQU0sQ0FBQ1EsV0FBVyxJQUFJNUQsUUFBUSxDQUFDNkQsZUFBZSxDQUFDRixVQUFVO1FBQ3RFRyxTQUFTLEdBQUdWLE1BQU0sQ0FBQ0UsV0FBVyxJQUFJdEQsUUFBUSxDQUFDNkQsZUFBZSxDQUFDQyxTQUFTO01BQ3hFLE9BQU87UUFBRWIsR0FBRyxFQUFFUSxJQUFJLENBQUNSLEdBQUcsR0FBR2EsU0FBUztRQUFFQyxJQUFJLEVBQUVOLElBQUksQ0FBQ00sSUFBSSxHQUFHSjtNQUFXLENBQUM7SUFDdEU7RUFDSixDQUFDO0VBOUJEUCxNQUFNLENBQUNuRCxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUcwQyxZQUFZLENBQUM7RUErQmhEcUIsVUFBVSxDQUFDLFlBQU07SUFDYnJCLFlBQVksQ0FBQyxDQUFDO0VBQ2xCLENBQUMsRUFBRSxHQUFHLENBQUM7QUFFWCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgY3VycmVudEluZGV4ID0gMTtcbiAgICBsZXQgc3RhcnRYID0gMDtcbiAgICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlO1xuXG4gICAgY29uc3Qgc2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByaXplX19zbGlkZXInKTtcbiAgICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcml6ZV9faXRlbScpO1xuICAgIGNvbnN0IHRvdGFsSXRlbXMgPSBpdGVtcy5sZW5ndGg7XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVTbGlkZXIoKSB7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IGluZGV4IC0gY3VycmVudEluZGV4O1xuICAgICAgICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gZGlzdGFuY2UgKiAzMy4zMztcblxuICAgICAgICAgICAgaWYgKGRpc3RhbmNlID4gdG90YWxJdGVtcyAvIDIpIHtcbiAgICAgICAgICAgICAgICBuZXdQb3NpdGlvbiAtPSB0b3RhbEl0ZW1zICogMzMuMzM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpc3RhbmNlIDwgLXRvdGFsSXRlbXMgLyAyKSB7XG4gICAgICAgICAgICAgICAgbmV3UG9zaXRpb24gKz0gdG90YWxJdGVtcyAqIDMzLjMzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzY2FsZSA9IGluZGV4ID09PSBjdXJyZW50SW5kZXggPyAxIDogMC44O1xuXG4gICAgICAgICAgICBpdGVtLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKCR7bmV3UG9zaXRpb259JSkgc2NhbGUoJHtzY2FsZX0pYDtcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUuekluZGV4ID0gaW5kZXggPT09IGN1cnJlbnRJbmRleCA/IDIgOiAxO1xuXG4gICAgICAgICAgICBjb25zdCBpc1Zpc2libGUgPSBNYXRoLmFicyhkaXN0YW5jZSkgPD0gMSB8fCAoaW5kZXggPT09IDAgJiYgY3VycmVudEluZGV4ID09PSB0b3RhbEl0ZW1zIC0gMSkgfHwgKGluZGV4ID09PSB0b3RhbEl0ZW1zIC0gMSAmJiBjdXJyZW50SW5kZXggPT09IDApO1xuICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nLCAhaXNWaXNpYmxlKTtcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgaW5kZXggPT09IGN1cnJlbnRJbmRleCk7XG5cbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnbGVmdC1zbGlkZScsICdyaWdodC1zbGlkZScpO1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlID09PSAxIHx8IChjdXJyZW50SW5kZXggPT09IHRvdGFsSXRlbXMgLSAxICYmIGluZGV4ID09PSAwKSkge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgncmlnaHQtc2xpZGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlzdGFuY2UgPT09IC0xIHx8IChjdXJyZW50SW5kZXggPT09IDAgJiYgaW5kZXggPT09IHRvdGFsSXRlbXMgLSAxKSkge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnbGVmdC1zbGlkZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtb3ZlU2xpZGVyKG9mZnNldCkge1xuICAgICAgICBjdXJyZW50SW5kZXggPSAoY3VycmVudEluZGV4ICsgb2Zmc2V0ICsgdG90YWxJdGVtcykgJSB0b3RhbEl0ZW1zO1xuICAgICAgICB1cGRhdGVTbGlkZXIoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVTdGFydChldmVudCkge1xuICAgICAgICBpc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgc3RhcnRYID0gZXZlbnQuY2xpZW50WCB8fCBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlTW92ZShldmVudCkge1xuICAgICAgICBpZiAoIWlzRHJhZ2dpbmcpIHJldHVybjtcblxuICAgICAgICBjb25zdCBjdXJyZW50WCA9IGV2ZW50LmNsaWVudFggfHwgZXZlbnQudG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgICBjb25zdCBkaWZmWCA9IGN1cnJlbnRYIC0gc3RhcnRYO1xuXG4gICAgICAgIGlmIChNYXRoLmFicyhkaWZmWCkgPiA1MCkge1xuICAgICAgICAgICAgbW92ZVNsaWRlcihkaWZmWCA+IDAgPyAtMSA6IDEpO1xuICAgICAgICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlRW5kKCkge1xuICAgICAgICBpc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgYnV0dG9uc0xlZnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV0dG9uLXNsaWRlci1sZWZ0JylcbiAgICBjb25zdCBidXR0b25zUmlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV0dG9uLXNsaWRlci1yaWdodCcpXG4gICAgYnV0dG9uc0xlZnQuZm9yRWFjaChidG4gID0+IHtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbW92ZVNsaWRlcigtMSk7XG4gICAgICAgIH0pXG4gICAgfSlcbiAgICBidXR0b25zUmlnaHQuZm9yRWFjaChidG4gID0+IHtcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbW92ZVNsaWRlcigxKTtcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZVN0YXJ0KTtcbiAgICBzbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGhhbmRsZVN0YXJ0KTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGhhbmRsZU1vdmUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGhhbmRsZU1vdmUpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGhhbmRsZUVuZCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBoYW5kbGVFbmQpO1xuXG4gICAgdXBkYXRlU2xpZGVyKCk7XG59KTtcblxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipBTklNQVRJT04qKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbmNvbnN0IGFuaW1JdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5fYW5pbS1pdGVtcycpO1xuXG5pZihhbmltSXRlbXMubGVuZ3RoID4gMCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnICwgYW5pbU9uU2Nyb2xsKVxuXG4gICAgZnVuY3Rpb24gYW5pbU9uU2Nyb2xsKHBhcmFtcyl7XG4gICAgICAgIGZvcihsZXQgaW5kZXg9MDsgaW5kZXg8YW5pbUl0ZW1zLmxlbmd0aDsgaW5kZXgrKyl7XG4gICAgICAgICAgICBjb25zdCBhbmltSXRlbSA9IGFuaW1JdGVtc1tpbmRleF07XG4gICAgICAgICAgICBjb25zdCBhbmltSXRlbUhpZ2h0ID0gYW5pbUl0ZW0ub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgY29uc3QgYW5pbUl0ZW1PZmZTZXQgPSBvZmZzZXQoYW5pbUl0ZW0pLnRvcDtcbiAgICAgICAgICAgIGNvbnN0IGFuaW1TdGFydCA9IDQ7XG5cbiAgICAgICAgICAgIGxldCBhbmltSXRlbVBvaW50ID0gd2luZG93LmlubmVySGVpZ2h0IC0gYW5pbUl0ZW1IaWdodCAvIGFuaW1TdGFydDtcblxuICAgICAgICAgICAgaWYoYW5pbUl0ZW1IaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCl7XG4gICAgICAgICAgICAgICAgYW5pbUl0ZW1Qb2ludCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHdpbmRvdy5pbm5lckhlaWdodCAvIGFuaW1TdGFydDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoKHBhZ2VZT2Zmc2V0ID4gYW5pbUl0ZW1PZmZTZXQtYW5pbUl0ZW1Qb2ludCkgJiYgcGFnZVlPZmZzZXQgPCAoYW5pbUl0ZW1PZmZTZXQgKyBhbmltSXRlbUhpZ2h0KSl7XG4gICAgICAgICAgICAgICAgYW5pbUl0ZW0uY2xhc3NMaXN0LmFkZCgnX3ZpZXcnKTtcbiAgICAgICAgICAgIH0gIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmKCFhbmltSXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ19hbmltLW5vLWhpZGUnKSl7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1JdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ192aWV3Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb2Zmc2V0KGVsKSB7XG4gICAgICAgICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgIHNjcm9sbExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQsXG4gICAgICAgICAgICAgICAgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgICAgICByZXR1cm4geyB0b3A6IHJlY3QudG9wICsgc2Nyb2xsVG9wLCBsZWZ0OiByZWN0LmxlZnQgKyBzY3JvbGxMZWZ0IH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGFuaW1PblNjcm9sbCgpO1xuICAgIH0sIDMwMCk7XG5cbn1cbiJdfQ==
